# 招待・クーポンシステム構築

## 概要

招待ユーザー向けにProプランを無料提供するクーポンシステムを実装し、ユーザー獲得と有料プラン利用促進を図る。

## 詳細

サブスクリプションベースのビジネスモデルでは、無料トライアルやフレンド招待プログラムが新規ユーザー獲得に効果的です。このタスクでは、招待クーポンの生成・管理、クーポン適用・認証フロー、招待メール送信機能を実装し、ユーザーがProプランを試用できる仕組みを構築します。

## 優先度

- **優先度**: P2
- **状態**: 未着手
- **期限**: 未設定
- **依存関係**: Stripe課金システム

## サブタスク

### 1. クーポンコード生成・管理システムの設計

- クーポンコードのデータモデル設計（有効期限、使用回数制限、適用プランなど）
- 管理者向けクーポン生成・管理UI
- クーポンコード自動生成アルゴリズム
- クーポン利用統計の収集システム

### 2. クーポン適用処理とユーザー認証フローの実装

- クーポン適用APIエンドポイント
- クーポン検証ロジック（有効期限、使用回数チェックなど）
- StripeとのProプラン連携処理
- クーポン適用後の課金スケジュール調整（無料期間後の課金開始）

### 3. 招待メール送信機能の開発

- 招待メールテンプレート設計
- メール送信サービス連携（SES、Sendgridなど）
- 招待リンク生成機能
- 招待追跡システム（開封率、転換率など）

### 4. クーポン利用状況の追跡と分析機能

- クーポン利用ダッシュボード
- コンバージョン率分析機能
- A/Bテスト実施基盤
- クーポンキャンペーン効果測定レポート

## 受け入れ基準

- 管理者が簡単にクーポンコードを生成・管理できること
- ユーザーがクーポンコードを使用してProプランに申し込み、無料期間が正しく適用されること
- 招待メールが適切に送信され、招待リンクが機能すること
- クーポン利用状況を追跡・分析できるダッシュボードが実装されていること

## リスクと考慮事項

- クーポンコードの悪用防止（ブルートフォース攻撃対策など）
- 同一ユーザーによる複数クーポン利用の制限
- 無料期間終了時の課金開始に関するユーザー通知
- クーポンキャンペーンのROI分析と調整メカニズム
