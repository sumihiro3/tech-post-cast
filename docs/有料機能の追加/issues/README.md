# Backlogチケット自動登録システム

## 概要

このディレクトリには、Tech Post Castの有料機能追加に関するタスクがMarkdownファイルで定義されています。
また、これらのタスクをBacklogのチケット（課題）として一括登録するためのシェルスクリプトが用意されています。

## ファイル構成

- `*.md`: 各タスクを定義したMarkdownファイル
- `../create_backlog_issues.sh`: Backlog APIを使ってチケットを登録するシェルスクリプト
- `../task_metadata.csv`: タスク固有の設定（課題タイプ、優先度、カテゴリ）を定義したCSVファイル

## 使い方

### 1. 設定

`create_backlog_issues.sh`を編集して、以下の項目を設定してください：

```bash
BACKLOG_SPACE="your-space"       # BacklogのスペースID
BACKLOG_PROJECT_ID="12345"       # プロジェクトID
```

また、デフォルト値も必要に応じて変更してください：

```bash
DEFAULT_ISSUE_TYPE_ID="123456"   # デフォルトの課題タイプID
DEFAULT_PRIORITY_ID="3"          # デフォルトの優先度ID
DEFAULT_CATEGORY_ID="9876"       # デフォルトのカテゴリID
```

実際のBacklogプロジェクトの設定に合わせて変更してください。

### 2. タスク固有の設定 (オプション)

`task_metadata.csv`を編集して、タスクごとに異なる課題タイプ、優先度、カテゴリを設定できます。
このファイルが存在しない場合、すべてのタスクにデフォルト設定が適用されます。

CSVの形式は以下の通りです：

```
タスク番号,課題タイプID,優先度ID,カテゴリID
01,123456,3,9876
02,123456,2,9876
...
```

- 各行は1つのタスクに対応しています
- タスク番号は「01」のように2桁の数字で指定してください
- 特定のタスクのみ設定したい場合は、そのタスクの行だけを追加すれば、他のタスクにはデフォルト設定が適用されます

### 3. 実行

```bash
cd /path/to/tech-post-cast
./docs/有料機能の追加/create_backlog_issues.sh YOUR_API_KEY
```

APIキーはセキュリティ上の理由からコマンドライン引数として渡す必要があります。このAPIキーはURLのクエリパラメーターとして使用されます（例: `https://xx.backlog.jp/api/v2/issues?apiKey=XXXX`）。

スクリプトを実行すると、確認メッセージが表示されます。「yes」と入力すると、すべてのタスクがBacklogに登録されます。

#### 使用例

```bash
# APIキーを直接指定する場合
./docs/有料機能の追加/create_backlog_issues.sh abcdef1234567890

# 環境変数から読み込む場合
./docs/有料機能の追加/create_backlog_issues.sh $BACKLOG_API_KEY
```

### 4. 新しいタスクの追加

新しいタスクを追加する場合は、このディレクトリに新しいMarkdownファイルを作成してください。
ファイル名は `XX-descriptive-name.md` の形式にしてください（XXは連番）。

各Markdownファイルは以下の形式で記述してください：

```markdown
# タスクのタイトル

## 概要
タスクの概要説明

## 詳細
- 詳細項目1
- 詳細項目2
- ...

## 受け入れ基準
- 基準1
- 基準2
- ...
```

また、新しいタスクの設定を`task_metadata.csv`に追加することを忘れないでください。

## 注意事項

- APIキーは公開リポジトリにコミットしないでください
- BacklogのAPIにはレート制限があるため、大量のタスクを一度に登録する場合は注意してください
- すでに登録済みのタスクを再度登録すると、重複して登録されてしまいます
